<!DOCTYPE html>
<html>
<head>
	<title>Photon Counting with NI Card</title>
</head>
<body>
	<h1>Photon Counting with NI Card</h1>
	<p>This tutorial explains how to perform photon counting using an NI card in Python.</p>
	
	<h2>What is Photon Counting?</h2>
	<p>Photon counting is the process of counting the number of photons detected by a photon detector. NI cards provide hardware support for photon counting, which can be used with Python to easily perform photon counting for various applications, such as fluorescence lifetime imaging microscopy (FLIM).</p>
	
	<h2>Getting Started</h2>
	<p>In order to get started with photon counting using an NI card in Python, you will need:</p>
	<ul>
		<li>An NI data acquisition card with analogue input channels</li>
		<li>A photon detector with analogue output</li>
		<li>A compatible version of Python installed on your computer</li>
	</ul>
	
	<h2>Performing Photon Counting with NI Card</h2>
	<p>Performing photon counting using an NI card involves creating a task, configuring the channels and timing, starting the task, and reading the acquired data. Here's an example script:</p>
	<pre>
	import PyDAQmx
	
	task = PyDAQmx.Task()
	
	task.CreateAIVoltageChan("Dev1/ai0", "", PyDAQmx.DAQmx_Val_Cfg_Default, -10.0, 10.0, PyDAQmx.DAQmx_Val_Volts, None)
	task.CfgSampClkTiming("", 100000.0, PyDAQmx.DAQmx_Val_Rising, PyDAQmx.DAQmx_Val_FiniteSamps, 10000)
	
	task.Start()
	
	data = numpy.zeros((10000,), dtype=numpy.float64)
	task.ReadAnalogF64(10000, 10.0, PyDAQmx.DAQmx_Val_GroupByScanNumber, data, 10000, PyDAQmx._byref(PyDAQmx.int32()), None)
	
	task.Stop()
	task.Clear()
	
	threshold = 0.1
	count = 0
	for i in range(10000):
		if data[i] > threshold:
			count += 1
	
	print("Number of photons counted: %d" % count)
	</pre>
	<p>This script creates a task for analogue input on ai0, configures the sampling clock to run at 100 kHz, starts the task, reads 10000 samples of analogue data, stops the task, and releases the task resources. The script then counts the number of samples where the signal exceeds a specified threshold, and prints the number of photons counted.</p>
	
	<h2>Conclusion</h2>
	<p>Photon counting with an NI card is a powerful tool for measuring the intensity of light sources or performing fluorescence lifetime imaging microscopy. With Python, you can easily set up and control photon counting tasks. We hope this tutorial has been helpful in getting you started with photon counting using an NI card in Python.</p>
</body>
</html>
